{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HintCallout = void 0;\nvar react_client_1 = require(\"@speechly/react-client\");\nvar react_1 = __importStar(require(\"react\"));\nvar types_1 = require(\"../types\");\nvar Callout_1 = require(\"./Callout\");\nvar HintCallout = function (props) {\n  var _a = react_1.useState(false),\n    visible = _a[0],\n    setVisible = _a[1];\n  var timeout = react_1.useRef(null);\n  var SHORT_PRESS_TRESHOLD_MS = 600;\n  var INSTRUCTION_PREROLL_MS = 500;\n  var INSTRUCTION_SHOW_TIME_MS = 3000;\n  react_1.useEffect(function () {\n    var subTangentPress = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentPress, function (message, payload) {\n      // console.log('TangentPress', payload.state)\n      hideHints();\n    });\n    var subTangentClick = PubSub.subscribe(types_1.SpeechlyUiEvents.TangentRelease, function (message, payload) {\n      // console.log('TangentRelease ', payload.state, payload.timeMs)\n      // Detect short record button presses\n      if (payload.timeMs < SHORT_PRESS_TRESHOLD_MS) {\n        switch (payload.state) {\n          case react_client_1.SpeechState.Ready:\n          case react_client_1.SpeechState.Recording:\n          case react_client_1.SpeechState.Loading:\n            if (timeout.current === null) {\n              timeout.current = window.setTimeout(function () {\n                setVisible(true);\n                timeout.current = window.setTimeout(function () {\n                  setVisible(false);\n                  timeout.current = null;\n                }, INSTRUCTION_SHOW_TIME_MS);\n              }, INSTRUCTION_PREROLL_MS);\n            }\n        }\n      }\n    });\n    return function () {\n      PubSub.unsubscribe(subTangentPress);\n      PubSub.unsubscribe(subTangentClick);\n    };\n  }, []);\n  var hideHints = function () {\n    setVisible(false);\n    if (timeout.current !== null) {\n      clearTimeout(timeout.current);\n      timeout.current = null;\n    }\n  };\n  return react_1.default.createElement(Callout_1.Callout, {\n    sourceAnchors: {\n      x: '50%',\n      y: '6%'\n    },\n    visible: visible,\n    onClick: function () {\n      return hideHints();\n    }\n  }, \"Hold to talk\");\n};\nexports.HintCallout = HintCallout;","map":{"version":3,"names":["react_client_1","require","react_1","__importStar","types_1","Callout_1","HintCallout","props","_a","useState","visible","setVisible","timeout","useRef","SHORT_PRESS_TRESHOLD_MS","INSTRUCTION_PREROLL_MS","INSTRUCTION_SHOW_TIME_MS","useEffect","subTangentPress","PubSub","subscribe","SpeechlyUiEvents","TangentPress","message","payload","hideHints","subTangentClick","TangentRelease","timeMs","state","SpeechState","Ready","Recording","Loading","current","window","setTimeout","unsubscribe","clearTimeout","default","createElement","Callout","sourceAnchors","x","y","onClick","exports"],"sources":["../../src/components/HintCallout.tsx"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,cAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAC,YAAA,CAAAF,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AACA,IAAAI,SAAA,GAAAJ,OAAA;AAEO,IAAMK,WAAW,GAAa,SAAAA,CAAAC,KAAK;EAClC,IAAAC,EAAA,GAAwBN,OAAA,CAAAO,QAAQ,CAAU,KAAK,CAAC;IAA/CC,OAAO,GAAAF,EAAA;IAAEG,UAAU,GAAAH,EAAA,GAA4B;EACtD,IAAMI,OAAO,GAAGV,OAAA,CAAAW,MAAM,CAAgB,IAAI,CAAC;EAE3C,IAAMC,uBAAuB,GAAG,GAAG;EACnC,IAAMC,sBAAsB,GAAG,GAAG;EAClC,IAAMC,wBAAwB,GAAG,IAAI;EAErCd,OAAA,CAAAe,SAAS,CAAC;IACR,IAAMC,eAAe,GAAGC,MAAM,CAACC,SAAS,CACtChB,OAAA,CAAAiB,gBAAgB,CAACC,YAAY,EAC7B,UAACC,OAAe,EAAEC,OAA+B;MAC/C;MACAC,SAAS,EAAE;IACb,CAAC,CACF;IACD,IAAMC,eAAe,GAAGP,MAAM,CAACC,SAAS,CACtChB,OAAA,CAAAiB,gBAAgB,CAACM,cAAc,EAC/B,UAACJ,OAAe,EAAEC,OAA+C;MAC/D;MACA;MACA,IAAIA,OAAO,CAACI,MAAM,GAAGd,uBAAuB,EAAE;QAC5C,QAAQU,OAAO,CAACK,KAAK;UACnB,KAAK7B,cAAA,CAAA8B,WAAW,CAACC,KAAK;UACtB,KAAK/B,cAAA,CAAA8B,WAAW,CAACE,SAAS;UAC1B,KAAKhC,cAAA,CAAA8B,WAAW,CAACG,OAAO;YACtB,IAAIrB,OAAO,CAACsB,OAAO,KAAK,IAAI,EAAE;cAC5BtB,OAAO,CAACsB,OAAO,GAAGC,MAAM,CAACC,UAAU,CAAC;gBAClCzB,UAAU,CAAC,IAAI,CAAC;gBAChBC,OAAO,CAACsB,OAAO,GAAGC,MAAM,CAACC,UAAU,CAAC;kBAClCzB,UAAU,CAAC,KAAK,CAAC;kBACjBC,OAAO,CAACsB,OAAO,GAAG,IAAI;gBACxB,CAAC,EAAElB,wBAAwB,CAAC;cAC9B,CAAC,EAAED,sBAAsB,CAAC;;;;IAIpC,CAAC,CACF;IACD,OAAO;MACLI,MAAM,CAACkB,WAAW,CAACnB,eAAe,CAAC;MACnCC,MAAM,CAACkB,WAAW,CAACX,eAAe,CAAC;IACrC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMD,SAAS,GAAG,SAAAA,CAAA;IAChBd,UAAU,CAAC,KAAK,CAAC;IACjB,IAAIC,OAAO,CAACsB,OAAO,KAAK,IAAI,EAAE;MAC5BI,YAAY,CAAC1B,OAAO,CAACsB,OAAO,CAAC;MAC7BtB,OAAO,CAACsB,OAAO,GAAG,IAAI;;EAE1B,CAAC;EAED,OAAOhC,OAAA,CAAAqC,OAAA,CAAAC,aAAA,CAACnC,SAAA,CAAAoC,OAAO;IAACC,aAAa,EAAE;MAAEC,CAAC,EAAE,KAAK;MAAEC,CAAC,EAAE;IAAI,CAAE;IAAElC,OAAO,EAAEA,OAAO;IAAEmC,OAAO,EAAE,SAAAA,CAAA;MAAM,OAAApB,SAAS,EAAE;IAAX;EAAW,kBAAwB;AAC5H,CAAC;AAtDYqB,OAAA,CAAAxC,WAAW,GAAAA,WAAA","ignoreList":[]},"metadata":{},"sourceType":"script"}